- + - + - + - + - + - + - + - + -
# Some flows to hardening /monitoring systems 
- + - + - + - + - + - + - + - + -

# Change all user passwords:
# List usernames only and output to file:
awk -F':' '{print $1}' /etc/passwd >> users.txt

# Format users.txt for password change and output to a new file:
sed 's/$/:IsThisIsADogsComplexPassword84/' users.txt >> users1.txt

# Use chpasswd to change passwords:
cat users1.txt | chpasswd

# End change all user passwords

# Change single user password
chpasswd
user:password
control + d

# View users with bash:
cat /etc/passwd | grep "/bin/bash"

# Show shells in use:
awk -F':' {print $7}' /etc/passwd|sort|uniq -c|sort -rn

# Add nologin:
cat /etc/shells
echo "/usr/sbin/nologin" >> /etc/shells

# Change user to nologin:
usermod -s /usr/sbin/nologin USERNAME

# Look at sudoers:
nano /etc/sudoers

# Cronjobs:
crontab -l
cd /etc/cron.daily .hourly .monthly .weekly 
cd/etc/cron.d
nano /etc/crontab

# Backup
mkdir backupdirectory
rsync -a --relative ~/TheFolder/ToBackUp . 

# Packages:
apt-cache pkgnames | grep telnet rsh, tftp, talk server
dpkg --list

# Remove package:
apt-get --purge remove packagename

# SSH
nano /etc/ssh/sshd_config
	PermitRootLogin no
	Protocol2
	ignoreRhosts yes
	HostBasedAuth no
	PermitEmptyPasswords no
	x11forward no
	maxauthtries 5
	ciphers aes128-ctr, aes192-ctr, aes256-ctr
	clientaliveint 900
	clientalivecountmax 0
	usepam yes

chown root:root /etc/ssh/sshd_config

# seLinux
nano /etc/selinux/config
	SELINUX = enforcing
  
# Monitoring
netstat -pant
tail -f /var/log/apache2/acces.log

# Red Team Tricks

# Immutable files
lsattr
chattr -i /folder orfilename 

# Re enable cursor / fix disappearing text in cmd
stty echo



